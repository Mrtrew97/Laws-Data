<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Laws Data</title>
    <style>
        /* Add your styles here (same as before) */
    </style>
</head>
<body>
    <div class="header-banner"></div>

    <div class="search-container">
        <input type="text" id="search" placeholder="Search for a name..." autocomplete="off">
    </div>

    <div id="data-container">
        <!-- Same as before with data-box elements -->
    </div>

    <script>
        let sheetData = [];

        // Fetch data from Google Sheets
        fetch("https://script.google.com/macros/s/AKfycbyVcVVn9z-QbjA_oy0Y3WSMBWh1OyEqBfOWd_GHiYag9VkOhux2lywnI3jZvHofvMyOQg/exec")
            .then(response => response.json())
            .then(data => {
                sheetData = data;
            })
            .catch(error => console.error("Error fetching data:", error));

        // Event listener for search input
        document.getElementById("search").addEventListener("input", function() {
            const searchQuery = this.value.toLowerCase();
            const foundPerson = sheetData.find(person => person["Name"].toLowerCase().includes(searchQuery));

            if (foundPerson) {
                displayData(foundPerson);
            } else {
                clearData();
            }
        });

        // Function to display data for the selected person
        function displayData(person) {
            const totalMerits = sheetData.reduce((sum, row) => sum + parseFloat(row["Merits Gained"] || 0), 0);
            const playerMerits = parseFloat(person["Merits Gained"] || 0);
            document.getElementById("merit-percentage").textContent = totalMerits ? ((playerMerits / totalMerits) * 100).toFixed(2) + "%" : "0%";

            document.getElementById("ap").textContent = person["AP"];
            document.getElementById("rank").textContent = person["Rank"];
            document.getElementById("merits-gained-detail").textContent = person["Merits Gained"];
            document.getElementById("heal-change").textContent = person["Heal Change"];
            document.getElementById("weekly-donations").textContent = person["Weekly Donations"];
        }

        // Function to clear the data if no match is found
        function clearData() {
            document.getElementById("average-ap").textContent = "No results found.";
            document.getElementById("ap").textContent = "";
            document.getElementById("rank").textContent = "";
            document.getElementById("merits-gained-detail").textContent = "";
            document.getElementById("heal-change").textContent = "";
            document.getElementById("weekly-donations").textContent = "";
        }
    </script>
</body>
</html>